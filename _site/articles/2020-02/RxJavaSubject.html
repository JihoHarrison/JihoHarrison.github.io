<!DOCTYPE html>
<html lang="en">





<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="description" content="  “RxJava 프로그래밍”이라는 책과 ReactiveX Subject 클래스 Documentation을 참고하여 공부한 내용입니다.😃🐼 Subject 클래스란?이전에 Observable 와 Single 에 대해 공부를 했다면!이제 Subject 클래스 라는 것도 알아보자.Rx ...">
  <meta name="keywords" content="blog and jekyll">
  <meta name="author" content="[RxJava] 🐼 Subject 클래스 | choheeis">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#f5f5f5">

  <!-- Twitter Tags -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="[RxJava] 🐼 Subject 클래스 | choheeis">
  <meta name="twitter:description" content="  “RxJava 프로그래밍”이라는 책과 ReactiveX Subject 클래스 Documentation을 참고하여 공부한 내용입니다.😃🐼 Subject 클래스란?이전에 Observable 와 Single 에 대해 공부를 했다면!이제 Subject 클래스 라는 것도 알아보자.Rx ...">
  
    <meta property="twitter:image" content="http://localhost:4000/img/leonids-logo.png">
  

  <!-- Open Graph Tags -->
  <meta property="og:type" content="blog">
  <meta property="og:url" content="http://localhost:4000/articles/2020-02/RxJavaSubject">
  <meta property="og:title" content="[RxJava] 🐼 Subject 클래스 | choheeis">
  <meta property="og:description" content="  “RxJava 프로그래밍”이라는 책과 ReactiveX Subject 클래스 Documentation을 참고하여 공부한 내용입니다.😃🐼 Subject 클래스란?이전에 Observable 와 Single 에 대해 공부를 했다면!이제 Subject 클래스 라는 것도 알아보자.Rx ...">
  
    <meta property="og:image" content="http://localhost:4000/img/leonids-logo.png">
  
  <title>[RxJava] 🐼 Subject 클래스 | choheeis</title>

  <!-- CSS files -->
  <link rel="stylesheet" href="http://localhost:4000/css/font-awesome.min.css">
  <link rel="stylesheet" href="http://localhost:4000/css/main.css">

  <link rel="canonical" href="http://localhost:4000/articles/2020-02/RxJavaSubject">
  <link rel="alternate" type="application/rss+xml" title="choheeis" href="http://localhost:4000/feed.xml" />

  <!-- Icons -->
  <!-- 16x16 -->
  <link rel="shortcut icon" href="http://localhost:4000/favicon.ico">
  <!-- 32x32 -->
  <link rel="shortcut icon" href="http://localhost:4000/favicon.png">
</head>


<body>
  <div class="row">
    <div class="col s12 m3">
      <div class="table cover">
        

<div class="cover-card table-cell table-middle">
  
  <a href="http://localhost:4000/">
    <img src="http://localhost:4000/img/avatar.png" alt="" class="avatar">
  </a>
  
  <a href="http://localhost:4000/" class="author_name">김초희</a>
  <span class="author_job">나는야 안드로이드 개발자 꿈나무 🍎</span>
  <span class="author_bio mbm">구경하러 오신 분들 모두 좋은 하루 되세요 🍉</span>
  <nav class="nav">
    <ul class="nav-list">
      <li class="nav-item">
        <a href="http://localhost:4000/">home</a>
      </li>
       
      <li class="nav-item">
        <a href="http://localhost:4000/archive/">Archive</a>
      </li>
            
      <li class="nav-item">
        <a href="http://localhost:4000/categories/">Categories</a>
      </li>
          
      <li class="nav-item">
        <a href="http://localhost:4000/resume/">Resume</a>
      </li>
          
      <li class="nav-item">
        <a href="http://localhost:4000/tags/">Tags</a>
      </li>
       
    </ul>
  </nav>
  <script type="text/javascript">
  // based on http://stackoverflow.com/a/10300743/280842
  function gen_mail_to_link(hs, subject) {
    var lhs,rhs;
    var p = hs.split('@');
    lhs = p[0];
    rhs = p[1];
    document.write("<a class=\"social-link-item\" target=\"_blank\" href=\"mailto");
    document.write(":" + lhs + "@");
    document.write(rhs + "?subject=" + subject + "\"><i class=\"fa fa-fw fa-envelope\"></i><\/a>");
  }
</script>
<div class="social-links">
  <ul>
    
      <li>
      <script>gen_mail_to_link('chchgml10@gmail.com', 'Hello from website');</script>
      </li>
    
    
    
    
    
    
    
    <li><a href="http://instagram.com/chooeeh" class="social-link-item" target="_blank"><i class="fa fa-fw fa-instagram"></i></a></li>
    
    <li><a href="http://github.com/choheeis" class="social-link-item" target="_blank"><i class="fa fa-fw fa-github"></i></a></li>
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
  </ul>
</div>

</div>

      </div>
    </div>
    <div class="col s12 m9">
      <div class="post-listing">
        <a class="btn" href= "http://localhost:4000/" >
  Home
</a>



<div id="post">
  <header class="post-header">
    <h1 title="[RxJava] 🐼 Subject 클래스">[RxJava] 🐼 Subject 클래스</h1>
    <span class="post-meta">
      <span class="post-date">
        24 FEB 2020
      </span>
      •
      <span class="read-time" title="Estimated read time">
  
  
    8 mins read
  
</span>

    </span>

  </header>

  <article class="post-content">
    <blockquote>
  <p><a href="https://www.aladin.co.kr/shop/wproduct.aspx?ItemId=116852658">“RxJava 프로그래밍”</a>이라는 책과 <a href="http://reactivex.io/documentation/subject.html">ReactiveX Subject 클래스 Documentation</a>을 참고하여 공부한 내용입니다.😃</p>
</blockquote>

<p><br /></p>

<h1 id="-subject-클래스란">🐼 Subject 클래스란?</h1>

<p>이전에 <a href="https://choheeis.github.io/rxjava/2020/02/03/RxJavaObservable.html">Observable</a> 와 <a href="https://choheeis.github.io/rxjava/2020/02/10/RxJavaSingle.html">Single</a> 에 대해 공부를 했다면!</p>

<p>이제 <strong>Subject 클래스</strong> 라는 것도 알아보자.</p>

<p><img src="https://user-images.githubusercontent.com/31889335/75418312-858f5e80-5976-11ea-91f8-9501a3f44111.PNG" alt="01" /></p>

<p>Rx 공식 문서를 보면 Subject 클래스를 다루는 배너가 있다. 파파고를 준비하고 한번 해석해보자ㅎㅎ</p>

<p><br /></p>

<p>Subject는 Observable 처럼 행동할 수 있고, observer 처럼 행동할 수도 있는 존재이다.</p>

<p>즉, Subject는 observer이기도 하기 때문에 하나 이상의 Observable을 구독할 수도 있고, 동시에 Observable이기도 하기 때문에 구독한 Observable에게 받은 item을 다시 방출할 수도 있다.</p>

<p>따라서 Subject는 Observable을 구독하고 있기 때문에 Observable이 item을 방출하도록 방아쇠를 당기는 역할을 한다. (Subject가 구독하는 Observable이 Cold Observable일 때를 말한다.)</p>

<p>여기서 잘 생각해보면 Subject는 Cold Observable을 Hot Observable로 바꿔줄 수 있다는 것을 알 수 있다.</p>

<p>예를 들어, Subject가 Cold Observable을 구독하여 구독한 시점부터 방출되는 item을 얻었다고 해보자.</p>

<p>Subject는 observer인 동시에 Observable이기도 하므로 Cold Observable에게 받은 item을 바로 방출하게 된다.</p>

<p>즉, Subject가 방출하는 item은 Hot Observable이 방출하는 방식과 같이 Observable이 생성되자 마자 바로 item이 방출되는 것이다!</p>

<p>그렇기 때문에 Subject는 Cold Observable을 Hot Observable로 바꿔준다고 할 수 있다.</p>

<p><br /></p>

<h2 id="subject는-총-4개의-subject로-나뉠-수-있다">Subject는 총 4개의 Subject로 나뉠 수 있다!</h2>

<p>밑에서 알아볼 4개의 Subject는 특정한 경우에 따라 각기 다르게 만들어진 Subject이다.</p>

<p>이 4개의 Subject가 ReactiveX를 구현한 모든 언어에서 사용되는 것은 아닐 수도 있고, 이름도 조금씩 바뀌어서 사용되는 경우도 있다.</p>

<p><br /></p>

<h1 id="-asyncsubject">🐼 AsyncSubject</h1>

<p>4개의 Subject 중 하나는 <strong>AsyncSubject</strong> 이다.</p>

<p>AsyncSubject는 Observable이 방출한 가장 마지막 item을 방출해준다. 이 때 AsyncSubject가 이 마지막 item을 방출해주는 시점은 기존 Observable이 종료된 순간이다.</p>

<p>밑의 마블 다이어그램을 보고 더 이해해보자!</p>

<p><img src="https://user-images.githubusercontent.com/31889335/75419651-a7d6ab80-5979-11ea-8cb1-f3e18cbdf897.PNG" alt="02" /></p>

<p>위 그림의 네모 박스 밑의 화살표 2개는 각각 observer를 나타내고 subscribe() 라고 되어있는 파란색 점선 화살표는 observer가 AsyncSubject를 구독한 시점이다.</p>

<p>즉, 여기서 AsyncSubject는 Observable로서 작동하고 있는 것이다!</p>

<p>이 마블 다이어그램을 보면 첫 번째 observer는 AsyncSubject를 맨 처음부터 구독했고, 두 번째 observer는 AsyncSubject를 파란색 동그라미 직전에 구독한 모습이다.</p>

<p>이 때, 두 구독자에게 방출되는 item은 AsyncSubject의 마지막 item 인 파란 동그라미뿐이며 방출되는 시점은 AsyncSubject가 끝난 시점이다.</p>

<blockquote>
  <p>마블 다이어그램에서</p>

  <p><img src="https://user-images.githubusercontent.com/31889335/75420174-c38e8180-597a-11ea-9b87-bbf5289e3ab6.PNG" alt="03" /></p>

  <p>위 그림의 빨간색 화살표 부분은 해당 Observable이 complete(완료)된 시점이라는 뜻이다!</p>
</blockquote>

<p>즉, AsyncSubject에 의해 두 구독자에게 방출되는 item은 같은 시간에 방출된다.</p>

<p>만약 AsyncSubject가 어떤 에러로 인해 종료되지 않는 상황이라면 AsyncSubject는 구독자들에게 어떠한 item도 방출하지 않을 것이다.</p>

<p>왜냐하면 AsyncSubject는 반드시 Observable이 완료된 후에 item을 방출하기 때문이다.</p>

<p><img src="https://user-images.githubusercontent.com/31889335/75420295-17996600-597b-11ea-8cab-acd6f149df1a.PNG" alt="04" /></p>

<p>위 그림을 보면 AsyncSubject는 완료되지 않았으므로 구독자들에게 방출되는 item이 없는 모습임을 알 수 있다.</p>

<p>그렇다면 AsyncSubject를 나타내는 RxJava 코드를 봐보자!</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// AsyncSubject를 create() 함수를 사용하여 생성한 모습 (Observable을 생성한 것과 같다.)</span>
        <span class="n">AsyncSubject</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">subject</span> <span class="o">=</span> <span class="n">AsyncSubject</span><span class="o">.</span><span class="na">create</span><span class="o">();</span>
        <span class="n">subject</span><span class="o">.</span><span class="na">subscribe</span><span class="o">(</span><span class="n">data</span> <span class="o">-&gt;</span> <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Subscriber #1 =&gt; "</span> <span class="o">+</span> <span class="n">data</span><span class="o">));</span>

         <span class="c1">// onNext함수는 item을 발행하는 함수이다.</span>
         <span class="c1">// AsyncSubject를 생성할 때 데이터 타입을 String이라고 했으므로 onNext가 발행하는 item의 타입도 String이여야 한다.</span>
        <span class="n">subject</span><span class="o">.</span><span class="na">onNext</span><span class="o">(</span><span class="s">"1"</span><span class="o">);</span>
        <span class="n">subject</span><span class="o">.</span><span class="na">onNext</span><span class="o">(</span><span class="s">"2"</span><span class="o">);</span>
        <span class="n">subject</span><span class="o">.</span><span class="na">subscribe</span><span class="o">(</span><span class="n">data</span> <span class="o">-&gt;</span> <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Subscriber #2 =&gt; "</span> <span class="o">+</span> <span class="n">data</span><span class="o">));</span>
        <span class="n">subject</span><span class="o">.</span><span class="na">onNext</span><span class="o">(</span><span class="s">"5"</span><span class="o">);</span>
        <span class="n">subject</span><span class="o">.</span><span class="na">onComplete</span><span class="o">();</span>
    <span class="o">}</span>    
</code></pre></div></div>

<p>위 코드의 실행결과는</p>

<p><img src="https://user-images.githubusercontent.com/31889335/75651778-c223c880-5c9c-11ea-85ac-0280822eee33.PNG" alt="10" /></p>

<p>이와 같다.</p>

<p>위 코드는 AsyncSubject가 complete된 시점에 두 observer에게 모두 마지막 item인 5가 방출된 모습을 보여준다.</p>

<p>위 코드에서는 AsyncSubject가 Observable으로서 사용된 것이다.</p>

<p>그렇다면 observer로서 사용된 예시도 봐보자.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Float</span><span class="o">[]</span> <span class="n">temperature</span> <span class="o">=</span> <span class="o">{</span><span class="mf">10.1f</span><span class="o">,</span> <span class="mf">13.4f</span><span class="o">,</span> <span class="mf">12.5f</span><span class="o">};</span>

        <span class="c1">// 온도 데이터를 담는 Observable 생성 (생성만 하고 아직 구독하지 않은 상태)</span>
        <span class="n">Observable</span><span class="o">&lt;</span><span class="n">Float</span><span class="o">&gt;</span> <span class="n">source</span> <span class="o">=</span> <span class="n">Observable</span><span class="o">.</span><span class="na">fromArray</span><span class="o">(</span><span class="n">temperature</span><span class="o">);</span>

        <span class="c1">// AsyncSubject 생성 (아직 Observable로 쓰일지 observer로 쓰일지 모름)</span>
        <span class="n">AsyncSubject</span><span class="o">&lt;</span><span class="n">Float</span><span class="o">&gt;</span> <span class="n">subject</span> <span class="o">=</span> <span class="n">AsyncSubject</span><span class="o">.</span><span class="na">create</span><span class="o">();</span>
        <span class="n">subject</span><span class="o">.</span><span class="na">subscribe</span><span class="o">(</span><span class="n">data</span> <span class="o">-&gt;</span> <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Subscriber #1 =&gt; "</span> <span class="o">+</span> <span class="n">data</span><span class="o">));</span>

        <span class="c1">// subject가 온도 데이터를 담은 Observable을 구독하는 구독자로 쓰임</span>
        <span class="n">source</span><span class="o">.</span><span class="na">subscribe</span><span class="o">(</span><span class="n">subject</span><span class="o">);</span>
    <span class="o">}</span>
</code></pre></div></div>

<p>위 코드의 실행결과는</p>

<p><img src="https://user-images.githubusercontent.com/31889335/75653705-76275280-5ca1-11ea-8822-4aca6f0243ca.PNG" alt="11" /></p>

<p>이와 같다. Observable이 발행한 마지막 데이터인 12.5가 출력된 모습이다.</p>

<p><br /></p>

<h1 id="-behaviorsubject">🐼 BehaviorSubject</h1>

<p>4개의 Subject에 포함되는 Subject에는 <strong>BehaviorSubject</strong> 라는 것이 있다.</p>

<p>observer가 BehaviorSubject를 구독하면 구독한 시점에 Observable이 가장 최근에 방출했던 item을 observer에게 방출해준다.</p>

<p>또는 가장 최근에 방출한 item이 없다면 기본값을 방출해준다.</p>

<p>이것도 아래 마블다이어그램을 보고 이해해보자.</p>

<p><img src="https://user-images.githubusercontent.com/31889335/75421322-56c8b680-597d-11ea-8ca0-243aad609fa7.PNG" alt="05" /></p>

<p>위 그림을 보면 두 observer는 각각 BehaviorSubject를 구독한 시점이 다르게 배치되어 있다.</p>

<p>첫 번째 구독자는 BehaviorSubject를 빨간 동그라미 이전에 구독했으므로 빨간 동그라미 이전에 방출된 가장 최근값이 없는 상황이다.</p>

<p>이 때는 BehaviorSubject의 기본값으로 갖고 있는 핑크색 동그라미를 방출하게 된다.</p>

<p>두 번째 구독자는 파란색 동그라미 이전에 구독하므로 그 시점에서 가장 최근에 방출된 item인 연두색 동그라미를 얻게 된다.</p>

<p>두 구독자 모두 BehaviorSubject에 의해 방출된 item을 얻은 후에도 계속 Observable이 방출하는 다른 item들도 얻는 모습을 볼 수 있다.</p>

<p>즉, BehaviorSubject는 가장 최근에 방출했던 item이나 기본 item을 먼저 방출해주고, 나머지 item을 계속 이어서 방출해준다는 걸 알 수 있다.</p>

<p><img src="https://user-images.githubusercontent.com/31889335/75421566-e4a4a180-597d-11ea-8f4a-4a3d95cc8c8f.PNG" alt="06" /></p>

<p>하지만 위 마블 다이어그램처럼 만약 Observable이 끝나지 않는다면 observer는 item을 얻을 수 없음을 알 수 있다.</p>

<p>그렇다면 RxJava 코드로 위 마블 다이어그램과 같은 BehaviorSubject를 구현해보자.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="c1">// 기본값이 1인 BehaviorSubject 생성</span>
    <span class="n">BehaviorSubject</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">subject</span> <span class="o">=</span> <span class="n">BehaviorSubject</span><span class="o">.</span><span class="na">createDefault</span><span class="o">(</span><span class="s">"1"</span><span class="o">);</span>

    <span class="c1">// 이 시점에 구독한 observer는 기본값 1을 얻게됨</span>
    <span class="n">subject</span><span class="o">.</span><span class="na">subscribe</span><span class="o">(</span><span class="n">data</span> <span class="o">-&gt;</span> <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Subscribe #1 =&gt; "</span> <span class="o">+</span> <span class="n">data</span><span class="o">));</span>        <span class="n">subject</span><span class="o">.</span><span class="na">onNext</span><span class="o">(</span><span class="s">"2"</span><span class="o">);</span>
    <span class="n">subject</span><span class="o">.</span><span class="na">onNext</span><span class="o">(</span><span class="s">"3"</span><span class="o">);</span>

    <span class="c1">// 이 시점에 구독한 observer는 3을 얻게됨</span>
    <span class="n">subject</span><span class="o">.</span><span class="na">subscribe</span><span class="o">(</span><span class="n">data</span> <span class="o">-&gt;</span> <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Subscribe #2 =&gt; "</span> <span class="o">+</span> <span class="n">data</span><span class="o">));</span>        <span class="n">subject</span><span class="o">.</span><span class="na">onNext</span><span class="o">(</span><span class="s">"5"</span><span class="o">);</span>
    <span class="n">subject</span><span class="o">.</span><span class="na">onComplete</span><span class="o">();</span>
</code></pre></div></div>

<p>이 코드의 실행결과는</p>

<p><img src="https://user-images.githubusercontent.com/31889335/75655029-580f2180-5ca4-11ea-823d-25b61fdb6481.PNG" alt="12" /></p>

<p>이와 같다!</p>

<p><br /></p>

<h1 id="-publishsubject">🐼 PublishSubject</h1>

<p>또 다른 Subject 중 하나인 <strong>PublishSubject</strong> 에 대해서 알아보자.</p>

<p>PublishSubject는 observer가 자신을 구독한 시점 이후로 방출되는 item만을 observer에게 방출해준다.</p>

<p>이것 또한 아래의 마블 다이어그램을 보고 이해해보자.</p>

<p><img src="https://user-images.githubusercontent.com/31889335/75650330-e41b4c00-5c98-11ea-9837-26a0bedc0782.PNG" alt="07" /></p>

<p>이 그림에서 두 명의 observer는 각각 PublishSubject에 의해 받는 item이 다르다.</p>

<p>첫 번째 observer는 자신이 구독한 시점 이후에 PublishSubject가 방출하는 item만을 받고 두 번째 observer는 같은 방식으로 자신이 구독한 시점 이후에 PublishSubject가 방출하는 item만을 받는다.</p>

<p>여기서 주의할 점은 PublishSubject는 자신이 생성된 즉시 아이템을 방출하기 시작하기 때문에 observer는 자신이 구독하기 이전 시점에 PublishSubject에서 방출된 item들은 얻지 못한다는 점이다.</p>

<blockquote>
  <p>만약 PublishSubject가 방출하는 모든 item을 얻고 싶다면 Observable을 생성할 때 create() 함수로 생성하거나 ReplaySubject를 사용해야 한다.</p>

  <p>create() 함수로 생성하면 PublishSubject를 조작적으로 cold Observable로 바꿀 수 있기 때문이다.</p>
</blockquote>

<p>만약 PublishSubject의 Observable이 에러와 함께 종료된다면 observer에게 더 이상 item을 줄 수 없게 된다.</p>

<p><img src="https://user-images.githubusercontent.com/31889335/75650588-a965e380-5c99-11ea-8f1d-e1df04bf5028.PNG" alt="08" /></p>

<p>Rxjava로 위의 PublishSubject를 구현해보자.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">PublishSubject</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">subject</span> <span class="o">=</span> <span class="n">PublishSubject</span><span class="o">.</span><span class="na">create</span><span class="o">();</span>
        <span class="n">subject</span><span class="o">.</span><span class="na">subscribe</span><span class="o">(</span><span class="n">data</span> <span class="o">-&gt;</span> <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Subscriber #1 =&gt; "</span> <span class="o">+</span> <span class="n">data</span><span class="o">));</span>
        <span class="n">subject</span><span class="o">.</span><span class="na">onNext</span><span class="o">(</span><span class="s">"1"</span><span class="o">);</span>
        <span class="n">subject</span><span class="o">.</span><span class="na">onNext</span><span class="o">(</span><span class="s">"2"</span><span class="o">);</span>
        <span class="n">subject</span><span class="o">.</span><span class="na">subscribe</span><span class="o">(</span><span class="n">data</span> <span class="o">-&gt;</span> <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Subscriber #2 =&gt; "</span> <span class="o">+</span> <span class="n">data</span><span class="o">));</span>
        <span class="n">subject</span><span class="o">.</span><span class="na">onNext</span><span class="o">(</span><span class="s">"3"</span><span class="o">);</span>
        <span class="n">subject</span><span class="o">.</span><span class="na">onComplete</span><span class="o">();</span>
    <span class="o">}</span>
</code></pre></div></div>

<p>위 코드의 실행결과는</p>

<p><img src="https://user-images.githubusercontent.com/31889335/75748646-535d7280-5d63-11ea-836d-ac07d6f10f90.PNG" alt="13" /></p>

<p>이와 같다. subscriber 1은 1, 2, 3을 모두 얻고, subscriber 2는 3만 얻는 모습을 볼 수 있다.</p>

<p><br /></p>

<h1 id="-replaysubject">🐼 ReplaySubject</h1>

<p>4개의 Subject중 마지막 Subject인 ReplaySubject에 대해서 알아보자.</p>

<p>ReplaySubject는 Observable이 방출한 모든 아이템을 자신을 구독한 observer에게 방출한다.</p>

<p>이 때, observer가 자신을 구독한 시점이 언제이든지 상관없이 모든 item을 방출한다.</p>

<p><img src="https://user-images.githubusercontent.com/31889335/75650659-ec27bb80-5c99-11ea-8fb4-e068dd13a828.PNG" alt="09" /></p>

<p>이 마블다이어그램을 보면 두 번째 구독자가 구독하자 마자 앞에서 이미 방출했던 빨간색, 연두색 동그라미들을 한번에 차례로 방출해주는 모습을 볼 수 있다.</p>

<p>즉, 모든 데이터를 저장해두었다가 새로운 subscriber가 생기면 저장해둔 데이터를 한 번에 주는 것이다.</p>

<p>그렇기 때문에 모든 데이터 내용을 저장해두는 과정에서 메모리 누수가 발생할 가능성이 있으니 사용할 때 주의해야 한다.</p>

<p>만약 ReplaySubject를 사용한다면 다중 스레드로부터 onNext 함수를 호출하지 않도록 주의해야한다. 왜냐하면 이런 호출이 순차적인 호출이 아닌 동시적으로 호출될 수 있기 때문이다.</p>

<p>동시적으로 호출되면 Observable 계약에 위배되는 것이 된다.</p>

<p>그렇다면 Rxjava로 ReplaySubject를 구현해보자.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">ReplaySubject</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">subject</span> <span class="o">=</span> <span class="n">ReplaySubject</span><span class="o">.</span><span class="na">create</span><span class="o">();</span>
        <span class="n">subject</span><span class="o">.</span><span class="na">subscribe</span><span class="o">(</span><span class="n">data</span> <span class="o">-&gt;</span> <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Subscriber #1 =&gt; "</span> <span class="o">+</span> <span class="n">data</span><span class="o">));</span>
        <span class="n">subject</span><span class="o">.</span><span class="na">onNext</span><span class="o">(</span><span class="s">"1"</span><span class="o">);</span>
        <span class="n">subject</span><span class="o">.</span><span class="na">onNext</span><span class="o">(</span><span class="s">"2"</span><span class="o">);</span>
        <span class="n">subject</span><span class="o">.</span><span class="na">subscribe</span><span class="o">(</span><span class="n">data</span> <span class="o">-&gt;</span> <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Subscriber #2 =&gt; "</span> <span class="o">+</span> <span class="n">data</span><span class="o">));</span>
        <span class="n">subject</span><span class="o">.</span><span class="na">onNext</span><span class="o">(</span><span class="s">"3"</span><span class="o">);</span>
        <span class="n">subject</span><span class="o">.</span><span class="na">onComplete</span><span class="o">();</span>
    <span class="o">}</span>
</code></pre></div></div>

<p>위 코드의 실행결과는</p>

<p><img src="https://user-images.githubusercontent.com/31889335/75749103-5c027880-5d64-11ea-8e81-f280d6e66713.PNG" alt="14" /></p>

<p>이와 같다.</p>

<p><br /></p>

<blockquote>
  <p>여기까지 Subject 스터디 완료!</p>
</blockquote>

<p><br /></p>

  </article>

  <div id="comment">
    <script src="https://utteranc.es/client.js"
      repo="choheeis/blog-comments"
      issue-term="pathname"
      theme="github-light"
      crossorigin="anonymous"
      async>
    </script>
  </div>
</div>

<!--  -->

        <footer>
  &copy; 2021 김초희. Powered by <a href="http://jekyllrb.com/">Jekyll</a>, <a href="http://github.com/renyuanz/leonids/">leonids theme</a>
</footer>

      </div>
    </div>
  </div>
  <script type="text/javascript" src="http://localhost:4000/js/jquery-3.2.1.min.js"></script>
<script type="text/javascript" src="http://localhost:4000/js/main.js"></script>


</body>
</html>
